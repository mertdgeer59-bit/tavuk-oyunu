<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chicken Empires Enterprise</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --gold: #f3ba2f; --silver: #e5e7eb; --bg: #050505; --card: #121214; --accent: #22c55e; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: #fff; font-family: 'Poppins', sans-serif; margin: 0; overflow: hidden; height: 100vh; }

        /* Üst Panel */
        .top-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; padding: 12px; background: #000; border-bottom: 1px solid #222; position: fixed; top:0; width:100%; z-index:100; }
        .stat-box { background: var(--card); padding: 8px; border-radius: 10px; text-align: center; border: 1px solid #222; }
        .stat-box small { display: block; font-size: 8px; color: #888; text-transform: uppercase; }
        .stat-box b { font-size: 12px; color: var(--gold); }

        .main-content { margin-top: 75px; height: calc(100vh - 155px); overflow-y: auto; padding: 15px; }
        .page { display: none; }
        .active { display: block; }

        /* Kart Tasarımları */
        .pack-card { background: linear-gradient(145deg, #1a1a1c, #0a0a0a); border-radius: 16px; border: 1px solid #333; padding: 15px; margin-bottom: 15px; }
        .pack-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #222; padding-bottom: 8px; margin-bottom: 10px; }
        .pack-price { color: var(--accent); font-weight: 800; font-size: 18px; }
        .pack-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; font-size: 11px; color: #aaa; }
        .pack-grid span b { color: #fff; }

        .btn-action { width: 100%; background: #fff; color: #000; border: none; padding: 12px; border-radius: 10px; font-weight: 700; cursor: pointer; margin-top: 10px; }
        .btn-buy-silver { background: var(--accent); color: #fff; margin-bottom: 20px; }

        /* Alt Menü */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: #000; display: flex; padding: 10px 0 30px; border-top: 1px solid #222; z-index: 100; }
        .nav-btn { flex: 1; text-align: center; color: #444; font-size: 10px; cursor: pointer; transition: 0.3s; }
        .nav-btn.active { color: var(--gold); }
        .nav-btn i { font-size: 20px; display: block; margin-bottom: 4px; }

        /* Depo & Takas Bölümü */
        .swap-card { background: var(--card); padding: 20px; border-radius: 15px; text-align: center; border: 1px solid #333; }
        .egg-display { font-family: 'Orbitron', sans-serif; font-size: 32px; color: #fff; margin: 15px 0; }
    </style>
</head>
<body>

    <div class="top-stats">
        <div class="stat-box"><small>Gümüş</small><b id="s-val">0</b></div>
        <div class="stat-box"><small>Altın Yumurta</small><b id="g-val">0</b></div>
        <div class="stat-box"><small>Çark Bileti</small><b id="t-val">0</b></div>
    </div>

    <div class="main-content">
        <div id="p-depo" class="page active">
            <div class="swap-card">
                <small style="color: #888;">TOPLAM ÜRETİM</small>
                <div class="egg-display" id="e-val">0</div>
                <div style="font-size: 12px; color: var(--accent);">+<span id="r-val">0</span> / Saat</div>
                <button class="btn-action" style="background: var(--gold);" onclick="swapEggs()">TAKAS ET (1.2x Gümüş)</button>
                <p style="font-size: 10px; color: #555; margin-top:10px;">Altın yumurtalar 1.2 kat gümüşe dönüşür.</p>
            </div>
        </div>

        <div id="p-magaza" class="page">
            <button class="btn-action btn-buy-silver" onclick="buySilver()">GÜMÜŞ AL (1$ = 12.000 ⚪)</button>
            <div id="packs-container"></div>
        </div>

        <div id="p-tavuklar" class="page">
            <h3 style="margin-top:0;">Kümes Geliştir</h3>
            <div id="chickens-container"></div>
        </div>

        <div id="p-gorevler" class="page">
            <div class="pack-card" style="text-align: center;">
                <i class="fas fa-tasks fa-3x" style="color: var(--gold); margin-bottom: 15px;"></i>
                <h4>Günlük Görevler</h4>
                <p style="font-size: 12px; color: #888;">Çok yakında burada yeni görevler belirecek!</p>
            </div>
        </div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-btn" onclick="nav('p-magaza', this)"><i class="fas fa-store"></i>Mağaza</div>
        <div class="nav-btn" onclick="nav('p-gorevler', this)"><i class="fas fa-star"></i>Görevler</div>
        <div class="nav-btn active" onclick="nav('p-depo', this)"><i class="fas fa-warehouse"></i>Depo</div>
        <div class="nav-btn" onclick="nav('p-tavuklar', this)"><i class="fas fa-feather"></i>Tavuklar</div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let user = {
            s: parseInt(localStorage.getItem('ce_s')) || 1000, // Başlangıç gümüşü
            g: parseInt(localStorage.getItem('ce_g')) || 0, // Altın Yumurta
            e: parseFloat(localStorage.getItem('ce_e')) || 0, // Depodaki yumurta
            p: parseInt(localStorage.getItem('ce_p')) || 0, // Saatlik üretim
            t: parseInt(localStorage.getItem('ce_t')) || 0  // Çark bileti
        };

        const chickenData = [
            { id: 'n', name: 'Normal', p: 42, c: 1000 },
            { id: 'c', name: 'Çiftlik', p: 221, c: 5000 },
            { id: 'o', name: 'Organik', p: 1160, c: 25000 },
            { id: 'a', name: 'Altın', p: 6091, c: 125000 },
            { id: 'k', name: 'Kral', p: 31979, c: 625000 }
        ];

        const packs = [
            { usd: 15, n: 60, c: 8, o: 2, a: 0, k: 0, b: 3, sil: 15000 },
            { usd: 40, n: 55, c: 20, o: 6, a: 1, k: 0, b: 7, sil: 25000 },
            { usd: 90, n: 80, c: 12, o: 3, a: 1, k: 1, b: 15, sil: 55555 },
            { usd: 225, n: 200, c: 25, o: 10, a: 3, k: 2, b: 35, sil: 200000 },
            { usd: 450, n: 375, c: 50, o: 20, a: 7, k: 4, b: 75, sil: 500000 },
            { usd: 900, n: 750, c: 110, o: 40, a: 14, k: 9, b: 150, sil: 1000000 },
            { usd: 1800, n: 1500, c: 250, o: 100, a: 28, k: 20, b: 300, sil: 2000000 }
        ];

        function sync() {
            document.getElementById('s-val').innerText = user.s.toLocaleString();
            document.getElementById('g-val').innerText = user.g.toLocaleString();
            document.getElementById('t-val').innerText = user.t.toLocaleString();
            document.getElementById('e-val').innerText = Math.floor(user.e).toLocaleString();
            document.getElementById('r-val').innerText = user.p.toLocaleString();
            
            localStorage.setItem('ce_s', user.s);
            localStorage.setItem('ce_g', user.g);
            localStorage.setItem('ce_e', user.e);
            localStorage.setItem('ce_p', user.p);
            localStorage.setItem('ce_t', user.t);
        }

        function nav(id, el) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            el.classList.add('active');
        }

        function init() {
            // Market
            document.getElementById('chickens-container').innerHTML = chickenData.map(c => `
                <div class="pack-card" style="display:flex; justify-content:space-between; align-items:center;">
                    <div><b>${c.name} Tavuk</b><br><small style="color:var(--accent);">+${c.p}/saat</small></div>
                    <button class="btn-action" style="width:auto; margin:0;" onclick="buyChicken(${c.p}, ${c.c})">${c.c.toLocaleString()} ⚪</button>
                </div>
            `).join('');

            // Paketler
            document.getElementById('packs-container').innerHTML = packs.map(p => `
                <div class="pack-card">
                    <div class="pack-header"><span class="pack-price">${p.usd}$ Paket</span><i class="fas fa-box-open"></i></div>
                    <div class="pack-grid">
                        <span>Normal: <b>${p.n}</b></span><span>Çiftlik: <b>${p.c}</b></span>
                        <span>Organik: <b>${p.o}</b></span><span>Altın: <b>${p.a}</b></span>
                        <span>Kral: <b>${p.k}</b></span><span>Bilet: <b>${p.b}</b></span>
                        <span style="grid-column: span 2; color:var(--gold);">Gümüş: <b>${p.sil.toLocaleString()}</b></span>
                    </div>
                    <button class="btn-action" onclick="buyPack(${p.usd})">SATIN AL</button>
                </div>
            `).join('');
        }

        function buyChicken(prod, cost) {
            if (user.s >= cost) {
                user.s -= cost; user.p += prod; sync();
                tg.HapticFeedback.notificationOccurred('success');
            } else { tg.showAlert("Yetersiz Gümüş!"); }
        }

        function buyPack(usd) {
            tg.showConfirm(`${usd}$ değerindeki paketi almak istiyor musunuz?`, (ok) => {
                if(ok) {
                    const p = packs.find(x => x.usd === usd);
                    const totalProd = (p.n*42) + (p.c*221) + (p.o*1160) + (p.a*6091) + (p.k*31979);
                    user.p += totalProd;
                    user.s += p.sil;
                    user.t += p.b;
                    // Her 10 dolara +1 bilet bonusu
                    user.t += Math.floor(usd / 10);
                    sync();
                    tg.showAlert("Paket başarıyla aktif edildi!");
                }
            });
        }

        function buySilver() {
            tg.showConfirm("1$ karşılığında 12.000 Gümüş almak istiyor musunuz?", (ok) => {
                if(ok) {
                    user.s += 12000;
                    sync();
                    tg.showAlert("Gümüş hesabınıza eklendi!");
                }
            });
        }

        function swapEggs() {
            if (user.e >= 1) {
                let amount = Math.floor(user.e);
                user.e -= amount;
                user.s += Math.floor(amount * 1.2);
                user.g += amount; // Altın yumurta sayacına ekle
                sync();
                tg.HapticFeedback.impactOccurred('medium');
            } else { tg.showAlert("Takas edilecek yumurta yok!"); }
        }

        setInterval(() => {
            if (user.p > 0) {
                user.e += (user.p / 3600);
                sync();
            }
        }, 1000);

        init(); sync();
    </script>
</body>
</html>
